define("desktop:widget/wzcl-player/media/html5-media.js",function(e,t,i){function n(e,t){var i=null,n=null;l.call(this,e,t),e.is("video")?(n=e,n.removeAttr("poster"),n.removeAttr("preload"),n.removeAttr("autoplay")):(i=document.createElement("VIDEO"),e.append(i),i.muted=t.muted?"muted":!1,n=s(i)),i=n[0],i.paused||i.pause(),i.src="",i.loop=this.option.loop,this._$video=n,this._video=i,this._ready=!1,this._ended=!1,this._source=null,this._waiting=!0,this._load=!1,this._isFullScreen=!1,this._waitingDelayTriggerTimer=null,r(this),(this.option.preload||this.option.autoplay)&&this.load(),this.option.autoplay&&this.play()}function r(e){var t=e._video,i=e._$video,n=null;e.on("ready",function(){e._ready=!0,e._buffered=!1,e._ended=!1,(e.option.autoplay||!this._paused)&&e.play();var i=0;n=n||setInterval(function(){var r=null;t.buffered&&t.buffered.length&&(r=t.buffered.end(t.buffered.length-1)),r&&u(r,1e3)!=i&&(i=u(r,1e3),u(r,1e3)>=u(t.duration,1e3)&&!e._buffered&&(e._buffered=!0,clearInterval(n),n=0),e.fireEvent("buffer",[r,t.duration]))},500)}),i.on("loadedmetadata",function(){e.fireEvent("ready")}),i.on("timeupdate",function(){e._waiting&&e._video.readyState>=c.HAVE_FUTURE_DATA&&i.trigger("canplay"),e.fireEvent("progress",[Math.max(t.currentTime||0,0),t.duration])}),i.on("play pause resize",function(t){switch(t.type){case"play":e._paused=!1;break;case"pause":e._paused=!0}e.fireEvent(t.type)}),i.on("ended",function(){e._ended=!0,e.fireEvent("ended")}),i.on("seeking seeked",function(n){switch(e._waiting&&e._video.readyState>=c.HAVE_FUTURE_DATA&&i.trigger("canplay"),n){case"seeking":t.pause();break;case"seeked":t.play()}e.fireEvent("seek",[t.currentTime])}),i.on("volumechange",function(){e.fireEvent("volumeChange",[t.volume])}),i.on("canplay",function(){e._waiting=!1,clearTimeout(e._waitingDelayTriggerTimer),e.fireEvent("canplay"),e._video.paused||e.fireEvent("play")}),i.on("abort error",function(){e._load&&null!=e._source&&(clearTimeout(e._waitingDelayTriggerTimer),e.fireEvent("error",[0,e._source]))})}function o(e){return"no"!=c.canPlayType(e).toLowerCase()}function a(e){for(var t=0,i=v.length;i>t;t++)for(var n=v[t],r=0,a=e.length;a>r;r++){var u=e[r];if(n==u.type&&o(u.type))return u}}function u(e,t){return t=t||100,Math.round(e*t)/t}var s=e("common:widget/jquery/1.11.3/jquery.js"),d=e("common:widget/tool/utils.js"),l=e("desktop:widget/wzcl-player/media/media.js").Media,h=e("desktop:widget/wzcl-player/media/media.js").MediaType,c=(Object.prototype.hasOwnProperty,document.createElement("video")),v=[h.webm,h.mp4,h.ogg],p=n.prototype=d.create(l.prototype,n);p.load=function(e){var t=this;if(l.prototype.load.call(this,e),this._video.pause(),this._source=null,this._load=!0,this._video.src="",!this.sources||!this.sources.length)return void this.fireEvent("error",[1]);this.fireEvent("load");var i=a(t.sources);return i?(this._video.src=i.url,this._source=i,clearTimeout(this._waitingDelayTriggerTimer),void(this._waitingDelayTriggerTimer=setTimeout(function(){t._waiting=!0,t.fireEvent("waiting")},200))):void this.fireEvent("error",[1])},p.play=function(){return this._paused=!1,this._ended?void this.replay():void(this._ready&&this._video.play())},p.replay=function(){this.seek(0)},p.pause=function(){this._paused=!0,this._ready&&this._video.pause()},p.isPlaying=function(){return!this._video.paused},p.mute=function(e){e=0===arguments.length?!0:!!e,this._video.muted=e},p.getCurrentTime=function(){return this._video.currentTime},p.seek=function(e){var t=this;this._video.currentTime=Math.min(e,this._video.duration||0),this.fireEvent("progress",[this._video.currentTime,this._video.duration]),this._video.play(),clearTimeout(this._waitingDelayTriggerTimer),this._waitingDelayTriggerTimer=setTimeout(function(){t._waiting=!0,t.fireEvent("waiting")},200)},p.getVolume=function(){return this._video.volume},p.setVolume=function(e){this._video.muted||(this._video.volume=Math.min(1,Math.max(0,+e||0)))},p.isMuted=function(){return this._video.muted},p.getDuration=function(){return this._video.duration},p.getCurrentTime=function(){return this._video.currentTime},p.enterFullScreen=function(){},p.exitFullScreen=function(){},p.setSpeed=function(e){this._video.playbackRate=e},p.getSpeed=function(){return this._video.playbackRate},p.getPlayer=function(){return this._$video},p.resize=function(e,t){this._$video.css({width:e,height:t}),this._video.width=e,this._video.height=t,this.fireEvent("resize")},i.exports=n});