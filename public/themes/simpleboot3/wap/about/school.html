<extend name="public/layout"/>
<block name="head">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>校区分布</title>
    <meta charset="utf-8"/>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <!--<meta name="360-site-verification" content="5fa7bea6d97d20b12298027a9bf21c3c" />-->

    <!--<meta name="baidu-site-verification" content="SaIdCNVBqW" />-->
    <!--<link rel="shortcut icon" href="/static/common/static/lib/img/favicon.ico">-->
    <!--[if lt IE 9]>
    <script src="__WAPSTATIC__/js/html5shiv.min_831d9bc.js"></script>
    <script src="__WAPSTATIC__/js/es5-shim.min_02d3aac.js"></script>

    <![endif]-->
    <!-- Piwik -->
    <!-- End Piwik Code -->
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/all_87c2b88.css"/>
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/minimalist_04aeee2.css"/>
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/common_40bb2b7.css"/>
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/widget_523a7b5.css"/>
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css_new/footer-version-renew_04ac1ac.css"/>-->
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/declaration-popup_e299361.css"/>
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css_new/detail_4e0f096.css"/>-->
    <link rel="stylesheet" href="__WAPSTATIC__/css_new/page.css"/>

    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/all_87c2b88.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/minimalist_04aeee2.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/common_40bb2b7.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/widget_523a7b5.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/footer-version-renew_04ac1ac.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/declaration-popup_e299361.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/detail_4e0f096.css"/>-->
    <!--<link rel="stylesheet" href="__WAPSTATIC__/css/page.css"/>-->
    <style>
        .page li {
            display: inline;
        }
        .page li:first-child>span {
            margin-left: 0;
            border-bottom-left-radius: 0;
            border-top-left-radius: 0;
        }
        .page span {
            width: 30px;
            display: inline-block;
            font-size: 16px;
            text-decoration: none;
            height: auto;
        }
        .campusWrap .mapBox .leftMap {
            width: 770px;
        }
        .campusMap {
            background: #f6f6f6;
            height: auto;
            min-height: 890px;
        }
        .doorBox{
            min-height: 610px;
        }
    </style>
</block>
<block name="body">
    <!--[if lt IE 7]>
    <body class="lt-ie10 lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
    <!--[if IE 7]>
    <body class="lt-ie10 lt-ie9 lt-ie8 ie7"> <![endif]-->
    <!--[if IE 8]>
    <body class="lt-ie10 lt-ie9 ie8"> <![endif]-->

    <!--[if IE 9]>
    <body class="lt-ie10 ie9"> <![endif]-->
    <!--[if gt IE 9]> -->
    <body>
    <!-- <![endif]-->

    <div id="wrapper">
        <!---------nav导航---------->
        <include file="public/header" />

        <div id="content"  class="campusMap">
            <div class="campusWrap">
                <!-- 区域-->
                <div class="campusArea">
                    <ul>
                        <li data-district="0"><a href="{:url('/Wap/About/school')}">全部校区</a></li>
                        <notempty name="arealist">
                            <foreach name="arealist" item="a">
                                <li data-district="{$a.district}"><a href="{:url('/Wap/About/school',['district'=>$a['district']])}">{$a.area|default=''}</a></li>
                            </foreach>
                        </notempty>
                    </ul>
                </div>
                <!-- 地图-->
                <div class="mapBox">
                    <!--左边地图-->
                    <div class="leftMap">
                        <div id="allmap" class="container fl" style="width: 95%;height: 600px;margin: 30px auto"></div>
                    </div>
                    <!--右侧门店-->
                    <div class="rightDoor" style="width: 400px;">
                        <notemtpy name="schoolList">
                            <div class="doorBox">
                            <foreach name="schoolList" item="s">
                                    <a class="doorItem" data-lon="{$s.longitude}" data-lat="{$s.latitude}" data-id="{$s.id}">
                                        <p>{$s.title|default=''}</p>
                                        <p>电话：{$s.tel|default=''}</p>
                                        <p>地址：{$s.address|default=''}</p>
                                    </a>
                            </foreach>
                            </div>
                        </notemtpy>
                        <!-- 分页-->
                        <div class="page">
                            <ul>
                            {$page|default=''}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--<script src="__WAPSTATIC__/js/entrance.js" data-args="manual=true" class="zhiCustomBtn" id="zhichiScript"></script>-->
        <!----------底部------------>
        <include file="public/footer" />

        <div id="declaration-popup" class="">
            <!--<div class="mask"></div>-->
            <div class="inner-box">
                <b class="title">声明</b>
                <b class="member">各位家长学员:</b>
                <p></p>
                <p> </p>
                <div>
                    <span>望子成龙</span>
                    <i>2017年2月18日</i>
                </div>
                <img class="J-close-btn close" src="__WAPSTATIC__/picture/close_db52052.png">
            </div>
        </div>
    </div>


    <script type="application/json" data-id="wzcl.data.gradeTosubject">
        {}
    </script>
    <script type="application/json" data-id="wzcl.data.subjectLabel">
        {}
    </script>
    <script type="application/json" data-id="wzcl.data.gradeLabel">
        []
    </script>
    <script type="text/javascript" src="__WAPSTATIC__/js/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js_new/mod_96dd55b.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/common_e3a1aa0.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js_new/all_a8d1492.js"></script>
    <!--<script type="text/javascript" src="__WAPSTATIC__/js_new/tj_6aa9dec.js"></script>-->
    <script type="text/javascript" src="__WAPSTATIC__/js/evaluate_9c498a1.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/tool_857ec5d.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/widget_eb26251.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/footer-version-renew_414e344.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/declaration-popup_7b4a0f1.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/detail_3d55d41.js"></script>
    <script type="text/javascript" src="__WAPSTATIC__/js/jquery.baiduMap.min.js"></script>
    <script src="http://api.map.baidu.com/api?v=2.0&ak=HOU0Lkx2AAVGkWRZ5GtO92yDYfkkEDZg"></script>
    <script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>
    <script type="text/javascript">

        !function () {
            if (window.WZ_CFG === undefined) window.WZ_CFG = {};
            require('desktop:widget/nav-version5/nav-version5.js');
        }();
        !function () {
            require("desktop:widget/footer-version-download/footer-version-renew.js");
        }();
        !function () {
            require("desktop:widget/declaration-popup/declaration-popup.js");
        }();

    </script>
    <script type="text/javascript" src="__WAPSTATIC__/js/classes.js"></script></body>
    <script>(function() {var _53code = document.createElement("script");_53code.src = "https://tb.53kf.com/code/code/10179248/1";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(_53code, s);})();</script>
    <script>
        /*--------------点击按钮事件---------------*/
        $(function(){
            $('.campusArea li').each(function(){
                $(this).click(function(){
                    $(this).siblings().removeClass('active');
                });
                $(this).data('district')=="{$Request.param.district}" && $(this).addClass('active')||"{$Request.param.district}"=='' && $('.campusArea li:first-child').addClass('active')
            });

        })
    </script>
    <!--------百度地图-------->
    <script type="text/javascript">
        function addClickHandler(content,marker,title){
            marker.addEventListener("click",function(e){
                openInfo(content,e,title)}
            );
        }
        function openInfo(content,e,title){
            let p = e.target;
            let point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
            let infoWindow = new BMap.InfoWindow(content,{title:title,enableMessage:true});  // 创建信息窗口对象
            map.openInfoWindow(infoWindow,point); //开启信息窗口
        }
        $.ajax({
            url:'/Wap/About/getSchool',
            data:{
                district:"{$Request.param.district}",
                page:"{$Request.param.page}"
            },
            type:"POST",
            dataType:"JSON",
            success:function(data){
                console.log(data);
                if(data.code) {
                    map = new BMap.Map("allmap");
                    map.centerAndZoom(new BMap.Point(data.data[0].lng,data.data[0].lat), 13);
                    map.enableScrollWheelZoom(true);
                    for(let i=0;i<data.data.length;i++){
                        let marker = new BMap.Marker(new BMap.Point(data.data[i].lng,data.data[i].lat));  // 创建标注
                        let content = data.data[i].content.join("<Br>");
                        map.addOverlay(marker);               // 将标注添加到地图中
                        addClickHandler(content,marker,data.data[i].title);
                    }
                    $('.doorItem').on('click',function() {
                        let $this = this;
                        map.panTo(new BMap.Point($($this).data('lon'),$($this).data('lat')));
                        for(let i=0;i<data.data.length;i++){
                            if(parseInt($($this).data('id')) === parseInt(data.data[i].id))
                            {
                                let marker = new BMap.Marker(new BMap.Point(data.data[i].lng,data.data[i].lat));  // 创建标注
                                map.addOverlay(marker);               // 将标注添加到地图中
                                let infoWindow = new BMap.InfoWindow(data.data[i].content.join("<Br>"),{title:data.data[i].title,enableMessage:true});  // 创建信息窗口对象
                                map.openInfoWindow(infoWindow,new BMap.Point(data.data[i].lng,data.data[i].lat));
                            }
                        }
                    })
                }
            },error:function (e) {
                console.log(e)
            }
        });
    </script>
</block>

